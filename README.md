# BeyMeter

BeyMeter は、BEYBLADE Battle Pass（BBP）と接続して、シュートパワーと波形を可視化する Web アプリです。  
シュートの「いまの1本」と「履歴の傾向」を同じ画面で確認できます。

## 主な機能
- BBP との接続 / 切断
- ベイ装着状態の表示
- 直近シュートの表示
  - 記録シュートパワー
  - 推定シュートパワー
  - 最大シュートパワー
  - 波形（時間軸 0〜400ms 固定）
- 履歴と分析
  - 帯域（1000刻み）での絞り込み
  - 帯域グラフ（平均 / 重ね描き）
  - 基本データ / 詳細データ
- 指標ラベルの `ⓘ` 説明（PC: ホバー、タップ端末: タップ）

## 対応環境
- 推奨ブラウザ: Google Chrome（Web Bluetooth 対応）
- PC / iPad での利用を推奨
- Web Bluetooth の仕様上、接続操作はユーザー操作が必要です

## 使い方
### 1. 起動
```bash
npm install
npm run dev
```
ブラウザで表示されたURLを開きます。

### 2. BBP接続
1. BBP を起動し、必要に応じて長押しして接続待機状態にします
2. 画面右上の `接続する` を押します
3. ブラウザのデバイス選択ダイアログで BBP を選択し、ペア設定します
4. 接続後、ボタンは `切断する` に切り替わります

### 3. シュート測定
- シュートすると、直近の数値カードと波形が更新されます
- 下段の「履歴と分析」で、帯域別の傾向を確認できます

## 画面の見方
## ヘッダー
- `BBP 接続中 / 未接続`: 接続状態
- `ベイ装着 / ベイ未装着`: 装着状態
- エラー表示: 通信や解析で問題が起きた場合に表示

## 直近のシュート
- `記録`: BBPが保持する値
- `推定`: 補正後の推定値
- `最大`: 波形ピーク値
- 直近グラフ
  - X軸: 時間 (ms)
  - Y軸: シュートパワー（または入力トルク）
  - シュートパワー表示時は固定軸（0〜400ms / 0〜12000）

## 履歴と分析
- 左: 帯域リスト（例: `8000-8999`）
- 右: 選択帯域のグラフと集計
- 表示切替
  - シュートパワー / トルク
  - 平均 / 重ね描き

## 基本データ
- 直近シュート（記録 / 推定 / 最大）
- 選択帯域の `t_peak`（mean / p50）
- 履歴統計（EST）
  - 合計
  - 平均
  - 最高
  - 標準偏差

## 詳細データ
### シュート要素
- 最大入力トルク  
  - 意味: 第1ピークまでの区間で推定した「入力の強さ」の最大値
  - 解釈: 値が大きいほど初動の押し込みが強い傾向
  - 注意点: 単発の上下より、同じ条件での複数回平均で比較
- `t_50`（ms）  
  - 意味: 第1ピーク値の 50% に到達するまでの時間
  - 解釈: 小さいほど立ち上がりが速い
  - 注意点: ピーク値自体が変わると相対的に値も変化する
- `t_peak`（ms）  
  - 意味: シュート開始から「第1ピーク」に達するまでの時間
  - 解釈: 小さいほど早く最大域に到達
  - 注意点: 本アプリでは全体最大ではなく第1ピーク基準
- `slope_max`  
  - 意味: 第1ピークまでの区間での最大立ち上がり勾配（SP/ms）
  - 解釈: 大きいほど加速が鋭い
  - 注意点: ノイズや短時間の跳ね上がりで過大になることがある
- `auc_0_peak`  
  - 意味: 0ms から第1ピークまでの SP 積分（回転量の総和）
  - 解釈: 大きいほどピーク到達までに回転を稼げている
  - 注意点: 立ち上がりの「強さ」と「持続」の両方の影響を受ける
- `spike_score`  
  - 意味: 波形の突発的な尖りを表す指標
  - 解釈: 1 付近は自然、値が大きいほどスパイク傾向
  - 注意点: 短いノイズが混ざると上振れしやすい

### ベイブレード特性推定（ベイ＋環境）
- `α`（線形減衰）  
  - 意味: 主に摩擦系（軸・接触）に由来する減衰の推定値
  - 解釈: 大きいほど減速が強い傾向
  - 注意点: ベイ単体だけでなく床/スタジアム/姿勢の影響も含む
- `β`（高速域減衰）  
  - 意味: 高速域で効く減衰（空力要素を含む）の推定値
  - 解釈: 絶対値が大きいほど高速域で失速しやすい傾向
  - 注意点: 形状差だけでなく投げ方の乱れも反映される
- `smoothness`  
  - 意味: 波形の滑らかさ（小さいほど滑らか）
  - 解釈: 小さいほど再現性が高く、ブレが少ない傾向
  - 注意点: センサー由来の微小ノイズも含む
- 推定本数（n）  
  - 意味: 現在セッションで α/β 推定に使えたショット数
  - 解釈: n が多いほど推定の安定性が上がる
  - 注意点: n が少ないと値が不安定になりやすい
- ベイセッション  
  - 意味: 「ベイ交換」で区切った比較単位
  - 解釈: セッション内で比較すると条件差を抑えやすい
  - 注意点: セッションをまたぐ比較は環境差に注意
- ベイ＋環境判定  
  - 意味: α/β/smoothness から算出した傾向ラベル
  - 解釈: 持続型・高速失速型などの「傾向」を示す
  - 注意点: 診断ではなく、比較の目安として使う

## 指標の補足
- 各指標ラベル右の `ⓘ` を操作すると、意味・解釈・注意点を確認できます
- `mean / p50` は以下の意味です
  - `mean`: 平均
  - `p50`: 中央値（50パーセンタイル）
- 使い分けの目安
  - `mean`: 全体傾向を見る（外れ値の影響を受けやすい）
  - `p50`: 典型値を見る（外れ値に比較的強い）
- 比較時の推奨
  - 同じベイセッション内で比較する
  - 10本以上のショットで傾向を見る
  - 1本の結果で良し悪しを断定しない

## ベイ交換
- 「ベイ交換」ボタンで、推定系のセッションを切り替えられます
- 履歴全体は保持したまま、比較単位を分けられます

## 開発コマンド
```bash
npm run dev     # 開発サーバー
npm run build   # 本番ビルド
npm run lint    # Lint
npm run preview # ビルド結果の確認
```

## 注意事項
- Web Bluetooth の制約で、ブラウザ側ダイアログ操作は必要です
- 無線状況や端末状態により、接続の安定性は変動します
- 指標は比較用の補助情報です。単発結果だけで断定せず、複数回の傾向で判断してください

## ライセンス
このプロジェクトは **CC BY-NC-SA 4.0** で公開しています。  
無料での利用・改変・再配布は可能ですが、**商用利用（販売・有料配布・同梱販売）は禁止**です。  
詳細は `LICENSE` を参照してください。

## 作成者
- `@bahamutonX` (X): https://x.com/bahamutonX
